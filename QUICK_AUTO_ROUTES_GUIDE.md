# 🎯 Быстрая инструкция - Автоматические маршруты

## ✨ Что изменилось?

Маршруты пешеходов теперь **загружаются автоматически** для каждого этажа!

---

## 📍 Как это работает?

```
Выбрали этаж → Активировали "Движение пешеходов" → Маршруты загрузились!
```

### До:
```
❌ Нужно было вручную загружать маршруты для каждого этажа
```

### Сейчас:
```
✅ Автоматически загружаются при переключении этажа
✅ Хранятся в папках с планами
✅ Есть fallback на общую папку
✅ Всегда работает (дефолтные маршруты)
```

---

## 🗂️ Где хранятся маршруты?

### В папках планов (приоритет):

```
PUBLIC/plans/
├── floor-2-new/
│   └── routes-underground-ground.json ← Для подземно-надземного
├── floor 1/
│   └── routes-general-floor-1.json ← Для первого этажа
├── section-1-floor-2/
│   └── routes-section1-floor-2.json ← Для Секции 1, Этаж 2
├── section-1-floor-3/
│   └── routes-section1-floor-3-10.json ← Для Секции 1, Этажи 3-10
└── ...
```

### В общей папке (fallback):

```
PUBLIC/routes/
├── underground-ground.json
├── general-floor-1.json
├── section1-floor-2.json
└── ...
```

---

## 🔄 Порядок загрузки

```
1. localStorage (если пользователь сохранял)
   ↓
2. Папка плана /plans/.../routes-*.json
   ↓
3. Общая папка /routes/*.json
   ↓
4. Дефолтные встроенные маршруты
```

---

## 🎯 Для пользователя

### Простой workflow:

```
1. Выбрать любой этаж
2. Нажать "Движение пешеходов" ✓
3. Всё! Маршруты загрузились автоматически
```

### Переключение этажей:

```
Этаж 1 → Маршруты А
   ↓
Переключились на Этаж 2 → Маршруты Б (автоматически!)
   ↓
Переключились на Этаж 3 → Маршруты В (автоматически!)
```

---

## 🔍 Проверка в консоли

Откройте консоль браузера (F12) и увидите:

```javascript
// При активации "Движение пешеходов":
🔍 Попытка загрузки маршрутов: /plans/section-1-floor-2/routes-section1-floor-2.json
✅ Загружены маршруты из файла для section1-floor-2: 2

// При переключении этажа:
🔍 Попытка загрузки маршрутов: /plans/floor-2-new/routes-underground-ground.json
✅ Загружены маршруты из файла для underground-ground: 3
```

---

## 💾 Редактирование маршрутов

### Если сохранили свои маршруты:

```
1. Открыть редактор → Создать маршруты → Сохранить
   ↓
2. Маршруты сохраняются в localStorage
   ↓
3. В следующий раз загружаются ваши маршруты (приоритет!)
```

---

## ✅ Что даёт?

1. **Автоматизация** - не нужно ничего делать вручную
2. **Удобство** - переключили этаж = обновились маршруты
3. **Надёжность** - всегда работает (4 уровня fallback)
4. **Гибкость** - можете сохранить свои маршруты

---

## 🎨 Визуально

```
┌─────────────────────────────────────┐
│ [Этаж 1]     ПЛАН      [Фильтры]   │
│                        │            │
│  Клик →               │ Движение   │
│  [Этаж 2]             │ пешеходов ✓│
│     ↓                  │            │
│  Автоматически         │ Маршруты   │
│  загрузились           │ загружены! │
│  новые маршруты        │            │
└─────────────────────────────────────┘
```

---

## 📚 Документация

- `AUTO_ROUTES_LOADING_UPDATE.md` - полная документация
- Консоль браузера - логи загрузки

---

**Версия:** 2.4  
**Дата:** 07 октября 2025  
**Статус:** ✅ Работает

Приятного использования! 🚀

